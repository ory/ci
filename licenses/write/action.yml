name: "Generate license overview"
description: "List and check licenses"

inputs:
  author-email:
    description: "Author email for git commits"
    required: false
  author-name:
    description: "Author name for git commits"
    required: false

runs:
  using: "composite"
  steps:
    - name: List and write licenses
      run: |
        mkdir -p .reports
        .bin/list-licenses > .reports/dep-licenses.csv
      shell: bash
    - name: Commit result
      run: |
        if [ -n "${{ inputs.author-email }}" ]; then
          git config --global user.email "${{ inputs.author-email }}"
        fi
        if [ -n "${{ inputs.author-name }}" ]; then
          git config --global user.name "${{ inputs.author-name }}"
        fi
        git add .
        git commit -m "autogen: update license overview" || true
        git push
      shell: bash